{% extends "layouts/main-rebrand.html" %}

{% block pageTitle %}
  Admin - {{ serviceName }} – GOV.UK Prototype Kit
{% endblock %}

{% block header %}

  {{ govukHeader({
    productName: "Publisher",
    homepageUrl: "/index",
    serviceUrl: "/index",
    classes: "govuk-!-font-weight-bold",
    navigationClasses: "align-right",
    navigation: [
      {
          href: "#1",
          text: "Switch app"
      }
    ]
  }) }}

  {{ govukServiceNavigation({
    serviceUrl: "#",
    navigation: [
    {
      href: "my-content",
      text: "My content"
    },
    {
      href: "all-publications",
      text: "All publications"
    },
    {
      href: "2i-queue",
      text: "2i queue"
    },
    {
      href: "fact-check",
      text: "Fact check"
    },
    {
      href: "new-content",
      text: "New content"
    }
  ]
  }) }}

{% endblock %}

{% block content %}

<div class="govuk-grid-row">
  <div class="govuk-grid-column-two-thirds">

    <span class="govuk-caption-xl"></span>
    <h1 class="govuk-heading-xl"></h1>

    <dl class="govuk-summary-list content-item-summary">
      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key">Edition</dt>
        <dd class="govuk-summary-list__value" id="edition"></dd>
        <dd class="govuk-summary-list__actions govuk-summary-list__row--no-actions"></dd>
      </div>
      {% if data['status'] == "In 2i" %}
        <div class="govuk-summary-list__row">
          <dt class="govuk-summary-list__key">2i reviewer</dt>
          <dd class="govuk-summary-list__value" id="reviewer"></dd>
          <dd class="govuk-summary-list__actions">
            <a class="govuk-link govuk-link--no-visited-state" id="reviewer-link" href="#">Change<span class="govuk-visually-hidden">2i reviewer</span></a>
          </dd>
        </div>
      {% elif data['status'] == "Fact check sent" %}
        <div class="govuk-summary-list__row">
          <dt class="govuk-summary-list__key">Sent out</dt>
          <dd class="govuk-summary-list__value" id="sent-out"></dd>
          <dd class="govuk-summary-list__actions govuk-summary-list__row--no-actions"></dd>
        </div>
      {% elif data['status'] == "Scheduled" %}
        <div class="govuk-summary-list__row">
          <dt class="govuk-summary-list__key">Scheduled for</dt>
          <dd class="govuk-summary-list__value" id="scheduled"></dd>
          <dd class="govuk-summary-list__actions govuk-summary-list__row--no-actions"></dd>
        </div>
      {% endif %}
      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key">Assigned to</dt>
        <dd class="govuk-summary-list__value assignee"></dd>
        <dd class="govuk-summary-list__actions">
          <a class="govuk-link govuk-link--no-visited-state" href="#">Change<span class="govuk-visually-hidden"> assignee</span></a>
        </dd>
      </div>
    </dl>

    {% if data['status'] == "In 2i" %}
      {{ govukInsetText({
        id: "reviewer-actions",
        html: "
          <p class='govuk-body'><span class='assignee'></span> sent this edition to 2i.</p>
          <p class='govuk-body'><a href='#' class='govuk-link govuk-link--no-visited-state'>Request amendments</a></p>
          <p class='govuk-body'><a href='#' class='govuk-link govuk-link--no-visited-state'>No changes needed</a></p>
        "
      }) }}
    {% elif data['status'] == "Ready" %}
      {{ govukInsetText({
        id: "request-amendments",
        html: "
          <p class='govuk-body'><a href='#' class='govuk-link govuk-link--no-visited-state'>Request amendments</a></p>
        "
      }) }}
    {% endif %}
    
</div>

  <div class="govuk-grid-column-full">
    <nav class="moj-sub-navigation" aria-label="Sub navigation">
      <ul class="moj-sub-navigation__list">
        <li class="moj-sub-navigation__item"><a class="moj-sub-navigation__link" href="content-item-edit">Edit</a></li>
        <li class="moj-sub-navigation__item"><a class="moj-sub-navigation__link" href="content-item-tagging">Tagging</a></li>
        <li class="moj-sub-navigation__item"><a class="moj-sub-navigation__link" href="content-item-metadata">Metadata</a></li>
        <li class="moj-sub-navigation__item"><a class="moj-sub-navigation__link" href="content-item-history-and-notes">History and notes</a></li>
        <!-- <li class="moj-sub-navigation__item"><a class="moj-sub-navigation__link" href="content-item-related-external-links">Related external links</a></li> -->
        <li class="moj-sub-navigation__item"><a class="moj-sub-navigation__link" aria-current="page" href="content-item-admin">Admin</a></li>
      </ul>
    </nav>
  </div>

  <div class="govuk-grid-column-full">
    <h2 class="govuk-heading-l">Admin</h2>
  </div>

  <div class="govuk-grid-column-two-thirds  chapter-edit-form">

    {% if (data['status'] == "Scheduled") or (data['status'] == "Published") or (data['status'] == "Archived") %}

      <h3 class="govuk-heading-m govuk-!-margin-bottom-1">Is this beta content?</h3>
      <p class="govuk-body" id="is-this-beta-content">No</p>

      <!-- <h3 class="govuk-heading-m govuk-!-margin-bottom-1">Add a public change note?</h3>
      <p class="govuk-body" id="is-this-beta-content">No</p> -->
   
    {% else %}

      {{ govukRadios({
        classes: "govuk-radios",
        name: "IsThisBetaContent",
        fieldset: {
          legend: {
            text: "Is this beta content?",
            classes: "govuk-fieldset__legend--m"
          }
        },
        items: [
          {
            value: "yes",
            text: "Yes"
          },
          {
            value: "no",
            text: "No",
            checked: true
          }
        ]
      }) }}

      {% set publicChangeNoteHtml %}
      {{ govukTextarea({
        name: "publicChangeNote",
        id: "public-change-note",
        label: {
          text: "Public change note",
          classes: "govuk-label--m",
          isPageHeading: true
        },
        hint: {
          html: '
            Describe what changed, where, and why.
            Use full sentences and start with the most important information.
            For example, “College A has been removed from the registered sponsors list because its licence has been suspended.”
            <a class="govuk-link--no-visited-state" href="https://gov-uk.atlassian.net/l/cp/dwn06raQ" rel="noreferrer noopener" target="_blank">
              Read guidance on writing good change notes (opens in new tab)</a>.
          '
        }
      }) }}
      {% endset -%}

      <!-- <div id="add-a-public-change-note">
        {{ govukRadios({
          name: "addPublicChangeNote",
          fieldset: {
            legend: {
              text: "Add a public change note?",
              isPageHeading: true,
              classes: "govuk-fieldset__legend--m"
            }
          },
          hint: {
            text: "Tell users when published information has changed"
          },
          items: [
            {
              value: "yes",
              text: "Yes",
              hint: {
                text: "The note will be published on the page, emailed to users subscribed to alerts, and the ‘last updated’ date will change"
              },
              conditional: {
                html: publicChangeNoteHtml
              }
            },
            {
              value: "no",
              text: "No",
              checked: true
            }
          ]
        }) }}
      </div> -->
    
    {% endif %}

  </div>

  <div class="govuk-grid-column-one-third sticky options-sidebar">
    <div class="actions-sidebar">

      {% from "govuk/components/button/macro.njk" import govukButton %}

      {% if (data['status'] !== "Scheduled") and (data['status'] !== "Published") and (data['status'] !== "Archived") %}
    
        <button type="submit" data-prevent-double-click="true" class="govuk-button wide govuk-button--save govuk-button--progress" data-module="govuk-button">
          <span class="govuk-button__icon">
            <span class="govuk-button__text">Save</span>
          </span>
        </button>

        {{ govukButton({
          id: "add-a-public-change-note",
          text: "Add a public change note",
          classes: "govuk-button--secondary wide",
          href: "#"
        }) }}

      {% endif %}
    


      {% if (data['status'] == "Published") %}

        {{ govukButton({
          text: "Change content type",
          classes: "govuk-button wide"
        }) }}

        {{ govukButton({
          id: "unpublish",
          text: "Unpublish",
          classes: "govuk-button--secondary wide",
          href: "#"
        }) }}

      {% else %}

        {{ govukButton({
          text: "Delete this edition",
          classes: "govuk-button--secondary wide"
        }) }}

      {% endif %}
    
    </div>
  </div>

</div>

{% endblock %}

{% block pageScripts %}
  <script src="/public/javascripts/save-feedback.js"></script>
  <script src="/public/javascripts/content-item.js"></script>
{% endblock %}